+++
title = "detail"
date = 2019-02-27T15:45:19+08:00
tags = [""]
categories = [""]
draft = true
commentId="net-detail"
+++
# 网络模型
国际标准组织(ISO)制定了OSI模型。这个模型把网络通信的工作分为7层。1至4层被认为是低层，这些层与数据移动密切相关。5至7层是高层，包含应用程序级的数据。每一层负责一项具体的工作，然后把数据传送到下一层。
![](http://pic.artacode.com/osi-layer1.jpg)
而在我们实际应用中分为五层，如上图tcp/ip就是分了五层,`越往上就越靠近用户，越往下越靠近硬件。`

# 层与协议
每一层都完成一种功能，为了完成这些功能，就需要共同遵守 一些规则，而这些规则就叫做“协议”(protocol)  

网络的每一层，都定义了很多协议。这些协议的总称，叫“TCP/IP协议”。它是Internet最基本的协议、Internet国际互联网络的基础，由网络层的IP协议和传输层的TCP协议组成。这里需要注意，TCP/IP协议是一个大家族，不仅仅只有TCP和IP协议，它还包括其它的协议，如下图：
![](http://pic.artacode.com/20150313140722088.jpg)

# 物理层
两台计算机进行通讯 ，首先要做的就是将两台计算机进行连接 。物理层主要作用是将两台计算机通过有线介质（双绞线、光纤）或无线介质（无线电、微波、激光、红外线）进行连接，物理层传输的数据 只有0和1
![](http://pic.artacode.com/20150313141125292.jpg)

# 链路层
## 定义
单纯的 0 和 1 没有任何意义，必须规定解读方式：多少个电信号算一组？每个信号位有何意义？这就是“链接层”的功能，它在“物理层”的上方，确定了 0 和 1 的分组方式。
## 以太网协议
早期的时候，每家公司都有自己的电信号分组方式。逐渐地，一种叫做“以太网”（Ethernet）的协议，占据了主导地位。

以太网规定，一组电信号构成一个数据包，叫做“帧”（Frame）。每一帧分成两个部分：标头（Head）和数据（Data）。
![](http://pic.artacode.com/20150313141521836.jpg)
“标头”包含数据包的一些说明项，比如发送者、接受者、数据类型等等；"数据"则是数据包的具体内容。

“标头”的长度，固定为 18 字节。"数据"的长度，最短为 46 字节，最长为 1500 字节。因此，整个"帧"最短为 64 字节，最长为 1518 字节。如果数据很长，就必须分割成多个帧进行发送。

## MAC 地址
上文提到标头里存者发送者和接收者信息，那么发送者和接收者是如何标识的呢？  

以太网规定，连接网络的所有设备，都必须具有“网卡”接口。数据包必须从`一个网卡传输到另一个网卡`。通过网卡能够使不同的计算机之间连接，从而完成数据通信等功能。`网卡的地址，就是数据包的发送地址和接收地址，这叫做 MAC 地址。`
![](http://pic.artacode.com/b812c8fcc3cec3fda0edf902d288d43f86942723.jpg)

MAC地址，用于标识网络设备，类似于身份证号。每块网卡出厂的时候，都有一个全世界独一无二的 MAC 地址（理论上全球唯一），长度是 48 个二进制位，通常用 12 个十六进制数表示。
![](http://pic.artacode.com/mac_address.jpg)

# 网络层
## 网络层的由来
以太网协议，依靠 MAC 地址发送数据。理论上，单单依靠 MAC 地址，北京的网卡就可以找到深圳的网卡了，技术上是可以实现的。

但是，这样做有一个重大的缺点。以太网采用广播方式发送数据包，所有成员人手一“包”，不仅效率低，而且局限在发送者所在的子网络。也就是说，如果两台计算机不在同一个子网络，广播是传不过去的。这种设计是合理的，否则互联网上每一台计算机都会收到所有包，那会引起灾难（广播风暴）。


互联网是无数子网络共同组成的一个巨型网络，很像想象北京和深圳的电脑会在同一个子网络，这几乎是不可能的。
![](http://pic.artacode.com/20150313145612206.jpg)
因此，必须找到一种方法，能够区分哪些 MAC 地址属于同一个子网络，哪些不是。如果是同一个子网络，就采用广播方式发送，否则就采用“路由”方式发送。（“路由”就相当于现象生活中的路标，规定这些数据包的走向，就是指如何向不同的子网络分发数据包，这是一个很大的主题，本文不涉及。）遗憾的是，MAC 地址本身无法做到这一点。它只与厂商有关，与所处网络无关.  

这就导致了“网络层”的诞生。它的作用是引进一套新的地址，使得我们能够区分不同的计算机是否属于同一个子网络。这套地址就叫做“网络地址”，简称“网址”。

于是，“网络层”出现以后，每台计算机有了两种地址，一种是 MAC 地址，另一种是网络地址。两种地址之间没有任何联系，MAC 地址是绑定在网卡上的，网络地址则是管理员分配的，它们只是随机组合在一起。

网络地址帮助我们确定计算机所在的子网络，MAC 地址则将数据包送到该子网络中的目标网卡。因此，从逻辑上可以推断，必定是先处理网络地址，然后再处理 MAC 地址。

# IP 协议
规定网络地址的协议，叫做 IP 协议。它所定义的地址，就被称为 IP 地址。

目前，广泛采用的是 IP 协议第四版，简称 IPv4。这个版本规定，网络地址由 32 个二进制位组成。
![](http://pic.artacode.com/20150313151235199.jpg)

